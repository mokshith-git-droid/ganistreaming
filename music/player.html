<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Music Player - GANI HUB</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background: #141414; 
            color: white; 
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        .back-btn { 
            background: #666; 
            color: white; 
            border: none;
            padding: 12px 20px; 
            border-radius: 8px; 
            cursor: pointer;
            margin-bottom: 30px;
            font-size: 16px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
        }
        .music-header {
            margin-bottom: 40px;
        }
        .album-art {
            width: 300px;
            height: 300px;
            border-radius: 15px;
            margin: 0 auto 25px;
            object-fit: cover;
            box-shadow: 0 15px 35px rgba(0,0,0,0.5);
        }
        .music-title {
            color: #FF6B35;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        .music-artist {
            color: #00D4FF;
            font-size: 1.5em;
            margin-bottom: 5px;
        }
        .music-genre {
            color: #ccc;
            font-size: 1.1em;
        }
        .player-controls {
            background: #2d2d2d;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
        }
        .control-buttons {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 25px;
        }
        .control-btn {
            background: #FF6B35;
            color: white;
            border: none;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            margin: 0 15px;
            cursor: pointer;
            font-size: 1.5em;
            transition: transform 0.2s;
        }
        .control-btn:hover {
            transform: scale(1.1);
        }
        .play-btn {
            width: 70px;
            height: 70px;
            font-size: 1.8em;
        }
        .progress-container {
            margin-bottom: 20px;
        }
        .progress-bar {
            width: 100%;
            height: 6px;
            background: #555;
            border-radius: 3px;
            cursor: pointer;
            margin-bottom: 10px;
        }
        .progress {
            height: 100%;
            background: #FF6B35;
            border-radius: 3px;
            width: 0%;
            transition: width 0.1s;
        }
        .time-display {
            display: flex;
            justify-content: space-between;
            color: #ccc;
            font-size: 0.9em;
        }
        .volume-control {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }
        .volume-control input {
            width: 150px;
        }
        .error {
            text-align: center;
            color: #ff4444;
            font-size: 1.2em;
            padding: 40px;
        }
    </style>
</head>
<body>
    <button class="back-btn" onclick="goBack()">‚Üê Back to Music</button>

    <div class="container">
        <div class="music-header">
            <img id="albumCover" class="album-art" src="" alt="Album Cover">
            <h1 class="music-title" id="musicTitle">Loading...</h1>
            <p class="music-artist" id="musicArtist"></p>
            <p class="music-genre" id="musicGenre"></p>
        </div>

        <div class="player-controls">
            <div class="control-buttons">
                <button class="control-btn" onclick="previousTrack()">‚èÆ</button>
                <button class="control-btn play-btn" onclick="togglePlay()" id="playBtn">‚ñ∂</button>
                <button class="control-btn" onclick="nextTrack()">‚è≠</button>
            </div>

            <div class="progress-container">
                <div class="progress-bar" id="progressBar">
                    <div class="progress" id="progress"></div>
                </div>
                <div class="time-display">
                    <span id="currentTime">0:00</span>
                    <span id="totalTime">0:00</span>
                </div>
            </div>

            <div class="volume-control">
                <span>üîä</span>
                <input type="range" id="volumeSlider" min="0" max="100" value="50">
            </div>
        </div>
    </div>

    <audio id="audioPlayer" preload="metadata"></audio>

    <script>
        let currentTrack = null;
        let isPlaying = false;
        let tracks = [];
        let currentTrackIndex = 0;

        const audioPlayer = document.getElementById('audioPlayer');

        async function loadMusic() {
            const urlParams = new URLSearchParams(window.location.search);
            const musicId = urlParams.get('music');
            
            if (!musicId) {
                showError('No music selected');
                return;
            }

            try {
                const response = await fetch('../manager.json');
                const data = await response.json();
                tracks = data.music;
                currentTrackIndex = tracks.findIndex(t => t.id == musicId);
                
                if (currentTrackIndex !== -1) {
                    loadTrack(currentTrackIndex);
                } else {
                    showError('Music not found');
                }
            } catch (error) {
                showError('Error loading music');
            }
        }

        function loadTrack(index) {
            currentTrack = tracks[index];
            document.getElementById('musicTitle').textContent = currentTrack.title;
            document.getElementById('musicArtist').textContent = currentTrack.artist;
            document.getElementById('musicGenre').textContent = currentTrack.genre;
            document.getElementById('albumCover').src = currentTrack.cover;
            document.getElementById('totalTime').textContent = currentTrack.duration;
            
            // Set audio source
            audioPlayer.src = currentTrack.audioUrl;
        }

        function togglePlay() {
            if (isPlaying) {
                audioPlayer.pause();
                document.getElementById('playBtn').textContent = '‚ñ∂';
            } else {
                audioPlayer.play();
                document.getElementById('playBtn').textContent = '‚è∏';
            }
            isPlaying = !isPlaying;
        }

        function previousTrack() {
            currentTrackIndex = (currentTrackIndex - 1 + tracks.length) % tracks.length;
            loadTrack(currentTrackIndex);
            if (isPlaying) audioPlayer.play();
        }

        function nextTrack() {
            currentTrackIndex = (currentTrackIndex + 1) % tracks.length;
            loadTrack(currentTrackIndex);
            if (isPlaying) audioPlayer.play();
        }

        // Audio player events
        audioPlayer.addEventListener('timeupdate', function() {
            const currentTime = formatTime(audioPlayer.currentTime);
            const duration = formatTime(audioPlayer.duration);
            const progress = (audioPlayer.currentTime / audioPlayer.duration) * 100;
            
            document.getElementById('currentTime').textContent = currentTime;
            document.getElementById('progress').style.width = progress + '%';
        });

        audioPlayer.addEventListener('ended', function() {
            nextTrack();
        });

        // Volume control
        document.getElementById('volumeSlider').addEventListener('input', function() {
            audioPlayer.volume = this.value / 100;
        });

        // Progress bar click
        document.getElementById('progressBar').addEventListener('click', function(e) {
            const percent = e.offsetX / this.offsetWidth;
            audioPlayer.currentTime = percent * audioPlayer.duration;
        });

        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        function showError(message) {
            document.getElementById('musicTitle').textContent = 'Error';
            document.getElementById('musicArtist').textContent = message;
        }

        function goBack() {
            window.location.href = "music.html";
        }

        loadMusic();
    </script>
</body>
</html>
